{% extends "base_generic.html" %}
<html lang="en">
	<head>
    
		<title> {% block title %}{{ caller.first_term.Class }}/{{ caller.first_term.subject }}{% endblock %}</title>
	</head>
	 {% block content %}
   <style>
      label {
          overflow: hidden;
          background-color: dodgerblue;
          padding: 20px 10px;
          width: 83%;
          border-radius: 5px;
          margin-left: -53px;
          }
          @media (max-width: 900px) 
		{
  			label {
    				width: 100%;margin-left: 0px;
			}}
    </style>
	<body>
  	
  <label method="post" action="" style="box-shadow: 0px 0px 45px 0px rgba(0, 0, 0, 0.9);">
      <div class="capt"><u style="margin-left:0%;background-color:gray;border:1px solid white;border-radius:3px;">Account:  </u> <strong style="width:30%;border:1px solid gray;border-radius:3px;">{{ caller.first_term.teacher_name }} </strong><u style="margin-left:0%;background-color:gray;border:1px solid white;border-radius:3px;"> Last Updated: </u><i style="width:30%;border:1px solid gray;border-radius:3px;"> {{ caller.first_term.updated }}</i></div>
      {% csrf_token %}
      <br>
      <div><pre style="width:18%;line-height:3px;">TUTOR DETAIL</pre> 	</div>
      
      <table class="info_tab_marg" style="width:100%;border-radius:5px;border:1px solid gray;">
      <th>Accounts</th><th>Class</th><th>Subject</th><th colspan='3'>Terms</th>
      <tr>
        <td style="width:20%;">
          <select name="accounts" id="accounts" style="width:100%;background-color:blue;color:white;border-radius:5px;">
                  <option value="{{ caller.first_term.accounts.id }}">{{ caller.first_term.accounts.username.upper }}</option>
                  {% if user %}
                  {% for scr in user %}
                      <option name="accounts" id="edith_name" value="{{ scr.id }}">{{ scr.username.upper }}</option>
                  {% endfor %}
                  {% endif %}
              </select> 
        </td>
        <td style="width:20%;">
          <select value="{{ caller.first_term.Class }}" id="class" name="Class" style="width:100%;background-color:blue;color:white;border-radius:5px;">
            <option value="{{ caller.first_term.Class }}">{{ caller.first_term.Class }}</option>
            <option value="JSS 1">JSS 1</option>
            <option value="JSS 2">JSS 2</option>
            <option value="JSS 3">JSS 3</option>
            <option value="SSS 1">SSS 1</option>
            <option value="SSS 2">SSS 2</option>
            <option value="SSS 3">SSS 3</option>
          </select>
        </td>
        <td style="width:20%;">
          <select value="{{ caller.first_term.subject }}" id="Subject" style="width:100%;background-color:blue;color:white;border-radius:5px;">
            <option value="{{ caller.first_term.subject }}">{{ caller.first_term.subject }}</option>
            <option value="ACC">Account</option>
            <option value="AGR">Agric. Sc</option>
            <option value="ARB">Arabic</option>
            <option value="BIO">Biology</option>
            <option value="BST1">Basic Science</option>
	          <option value="BST2">Basic Technology</option>
            <option value="BST">Basic Science & Technology</option>
            <option value="BUS">Business Studies</option>
            <option value="CHE">Chemistry</option>
            <option value="CIV">Civic Education</option>
            <option value="COM">Commerce</option>
            <option value="CTR">Catring Services</option>
            <option value="DPN">Data Processing </option>
            <option value="ECO">Economics</option>
            <option value="ELE">Electrical</option>
            <option value="ENG">English Language</option>
            <option value="FUR">Further Mathematics</option>
            <option value="GEO">Geography</option>
            <option value="GOV">Government</option>
            <option value="GRM">Germent Maiking</option>
            <option value="HIS">History</option>
            <option value="ICT">Information Technology</option>
            <option value="IRS">Islamic Religion Studies</option>
            <option value="LIT">Literature</option>
            <option value="MAT">Mathematics</option>
            <option value="MKT">Marketing</option>
            <option value="NAV">Regional and National Value</option>
            <option value="PHY">Physics</option>
            <option value="PRV">Pre-Vocational Studies</option>
            <option value="YOR">Yoruba Language</option>
          </select>
        </td>
        <td>
          <select value="{{ caller.first_term.first_term }}" id="first_term" style="width:100%;background-color:blue;color:white;border-radius:5px;">
            <option value="{{ caller.first_term.first_term }}">{{ caller.first_term.first_term }}</option>
            <option value="1st Term">First Term</option>
            <option value="2nd Term">Second Term</option>
            <option value="3rd Term">Third Term</option>
          </select> 
        </td>
        <td>
          <select value="{{ caller.first_term.second_term }}" id="second_term" style="width:100%;background-color:blue;color:white;border-radius:5px;">
            <option value="{{ caller.first_term.second_term }}">{{ caller.first_term.second_term }}</option>
            <option value="1st Term">First Term</option>
            <option value="2nd Term">Second Term</option>
            <option value="3rd Term">Third Term</option>
          </select>
        </td>
        <td> 
          <select value="{{ caller.first_term.third_term }}" id="third_term" style="width:100%;background-color:blue;color:white;border-radius:5px;">
            <option value="{{ caller.first_term.third_term }}">{{ caller.first_term.third_term }}</option>
            <option value="1st Term">First Term</option>
            <option value="2nd Term">Second Term</option>
            <option value="3rd Term">Third Term</option>
          </select> 
        </td>
      </tr>
      </table>
      
    
      <div class="row" style="margin-left:1%;">
        <div class="col-xs-2" >
        <u> Males: </u> <pre style="line-height:5px;width:50%;">{{ caller.first_term.males }}</pre>
        </div>
        <div class="col-xs-2">
          <u>Females:</u> <pre style="line-height:5px;width:50%;">{{ caller.first_term.females }}</pre>
        </div>
        <div class="col-xs-2">
          <u>Both:</u> <pre style="line-height:5px;width:50%;">{{ caller.first_term.males |add:caller.first_term.females }}</pre>
        </div>
        <div class="col-xs-3">
          <u>Session:</u> <pre style="line-height:5px;width:50%;">{{ caller.first_term.session }}</pre>
        </div>
        <div class="col-xs-3">
          <u>Account Status: </u>
          <select value="{{ caller.first_term.status }}" id="status" style="width:100%;background-color:blue;color:white;border-radius:5px;">
            <option value="{{ caller.first_term.status }}">{{ caller.first_term.status }}</option>
            <option value="active">Active</option>
            <option value="delete">Delete</option>
          </select> 
        </div>
        
      </div>
      
    <table class="info_tab_marg" style="width:100%;border-radius:5px;border:1px solid gray;">
      <th rowspan="2" style="width:20%;"><pre style="width:100%;line-height:3px;">HOME DETAIL</pre></th><th><a href="{% url 'subject_view' pk=caller.first_term.id md=1 %}">Tutor</a></th><th>Homes</th><th colspan='3'>Terms</th>
      <tr>
        
        <td style="width:20%;">
          <select name="dropDown" id="tutor" style="width:100%;background-color:blue;color:white;border-radius:5px;">
                  <option value="{{ caller.tutor.id }}">{{ caller.tutor.username.upper }}</option>
                  {% if user %}
                  {% for scr in user %}
                      <option name="dropDownOpt" id="edith_name" value="{{ scr.id }}">{{ scr.username.upper }}</option>
                  {% endfor %}
                  {% endif %}
              </select> 
        </td>
        <td style="width:20%;">
          <select name="navigates" id="navigates" style="width:100%;background-color:blue;color:white;border-radius:5px;">
                  <option value="{{ caller.first_term.subject }}/{{ caller.first_term.Class }}">{{ caller.first_term.subject }}/{{ caller.first_term.Class }}</option>
                  {% if home %}
                  {% for scr in home %}
                      <option name="dropDownOpt" id="edith_name" value="{{ scr.first_term.id }}">{{ scr.first_term.subject }}/{{ scr.first_term.Class }}</option>
                  {% endfor %}
                  {% endif %}
              </select>
        </td>
        <td>
          <select value="{{ caller.first_term }}" id="home_first" style="width:100%;background-color:blue;color:white;border-radius:5px;">
            <option value="{{ caller.first_term.id }}">{{ caller.tutor }}</option>
            <option value="{{ caller.first_term.id }}">-------</option>
            <option value=" ">{{ caller.first_term }}</option>
          </select> 
        </td>
        <td>
          <select value="{{ caller.first_term }}" id="home_second" style="width:100%;background-color:blue;color:white;border-radius:5px;">
            <option value="{{ caller.first_term.id }}">{{ caller.tutor }}</option>
           <option value="{{ caller.first_term.id }}">-------</option>
            <option value=" ">{{ caller.first_term }}</option>
          </select>
        </td>
        <td> 
          <select value="{{ caller.first_term }}" id="home_third" style="width:100%;background-color:blue;color:white;border-radius:5px;">
            <option value="{{ caller.first_term.id }}">{{ caller.tutor }}</option>
          <option value="{{ caller.first_term.id }}">-------</option>
            <option value=" ">{{ caller.first_term }}</option>
          </select> 
        </td>
      </tr>
      </table>
      
      <br> 
      <button type='submit' name="submit" style="margin-left:44%;background-color:crimson;color:white;border-radius:5px;" id='save'>Save<span class="glyphicon glyphicon-ok" style="margin-right:5px;"></span><strong></strong></button>
      <button style="margin-left:44%;background-color:crimson;color:white;border-radius:5px;" id='home' hidden><a href="{% url 'home' %}" > Go Home <span class="glyphicon glyphicon-forward" style="margin-right:5px;"></span><strong></strong></a></button>
      
      <script>
      function redirect(to) {
					var next = window.location.href.split('/')[0]+'/result/'+to+"/";  
          window.open(next);
					};
      $("#navigates").change(function(){
          redirect($(this).val())
      });
           $("#home_first, #home_second, #home_third").change(function(){
             if ($(this).val() != ' '){
                    redirect($(this).val())
                    }
      });
      $("button[name='submit']").click(function(){
            var argument = { 
              accounts:$("#accounts").val(),
              status:'active', 
              Class:$("#class").val(), 
              Subject:$("#Subject").val(), 
              first_term:$("#first_term").val(), 
              second_term:$("#second_term").val(), 
              third_term:$("#third_term").val(), 
               };
                if ($("#status").val() == 'delete'){ var com = confirm('if this account is deleted, also '  + ""+'{{caller.first_term.males}}'+' males and '+ ""+'{{caller.first_term.females}}'+' females '+'{{caller.first_term.subject}}'+' subject scores will be deleted, click OK to continue.')
                 if (com == true) {argument.status = $("#status").val()}
                }
            var request = $.ajax({
                url:"{% url 'tutor_update' pk=pk %}",
                data: argument,
                dataType: 'json',
               });
                 request.done(function(data){
                 if (data.status){alert(data.status); $('#save').hide();$('#home').show()}else{
                        document.getElementById("class").value = data.Class;
                        document.getElementById("Subject").value = data.Subject;
                        document.getElementById("first_term").value = data.first_term;
                        document.getElementById("second_term").value = data.second_term;
                        document.getElementById("third_term").value = data.third_term;
                        var oldurl = document.referrer;
                        location.replace(oldurl)
             }});     
                   request.fail(function(xhr, status, error) {
       var errors = {'0':'Client connectivity', '500':'Internal Server' };
      var errorMessage = errors[xhr.status] + ': ' + xhr.statusText
      alert('Error - ' + errorMessage);
})
            });
        
      </script>
  </label>
	
</body>
	{% endblock %}
</html>




