<html>
	{% load static %}
<head>
  <title id='title'>data table</title>
  <!--Meta Tags-->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!--WWW Resources-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link href="https://fonts.googleapis.com/css?family=Noto+Serif|Open+Sans:300,400,600,700" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/0.9.0rc1/jspdf.min.js"></script>
	<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>  
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.min.js"></script>  
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<link href="//fonts.googleapis.com/css?family=Lobster&subset=latin,latin-ext" rel="stylesheet" type="text/css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="{% static 'result/css/frozeentable.css' %}">
  
  <!--External Resources-->
    <style>
      
	</style>
</head>

<body>

<!--Sidebar-->
<div class="sidebar open-sans">
  <span id="close"><i class="material-icons">close</i></span>
  <a href="#" class="Slogo">BT</a>
  <a href="#" id="l1" class="Slink">About</a>
  <a href="#" id="l2" class="Slink">Past Projects</a>
  <a href="#" id="l3" class="Slink">Our Work</a>
  <a href="#" id="l4" class="Slink">Enquiries</a>
</div>

						
<!--Navbar-->
<div class="nav-wrapper">
  <a href="index.html" class="logo open-sans"><img src="https://dhnygxib7cbg0.cloudfront.net/pdf/uqhs.jpg" alt="schLogo" height="60" width="60" style="border: 2px solid blue;border-radius:2px;"></a>
  <ul class="nav-container open-sans">
    <li class="nav-item"><em class="nav-link"><button type="button" class="btn btn-info" title="Reload" onclick="reload()"><span class="glyphicon glyphicon-refresh" style="color: white;"> Reload</span></button></em></li>
    <li class="nav-item"><em class="nav-link"><button type="button" class="btn btn-success" title="Final save of work for printing" onclick="saveState ()"><span class="glyphicon glyphicon-saved" style="color: white;"> Save</span></button></em></li>
    <li class="nav-item"><em class="nav-link"><button type="button" class="btn btn-primary" title="Print document in pdf" onclick="linkTable('home')"><span class="glyphicon glyphicon-download-alt" style="color: white;"> Print</span></button></em></li>
    <li class="nav-item"><em class="nav-link"><button type="button" class="btn btn-btn-link" title="Go to home page" onclick="location.replace(window.location.href.replace('tablefrozen/48/#', 'home'))"><span class="glyphicon glyphicon-home" style="color: white;"> Home</span></button></em></li>
    <li class="nav-icon"><em class="nav-link"><i class="fa fa-bars"></i></em></li>
  </ul>
</div>
<h1 style=""> UMMUL QURA HIGH SCHOOL </h1>
					
<div class="table-container">
	<table id=inputTable>        
		<tbody style="line-height:3px;">
			<thead>
				<tr><th style="text-align: center;">
          <div style="margin-left:12%;">
            <select value="" id="sclass" class="selectbut" required title="Select Class">
              <option value="">Class</option>
              <option value="JSS 1" class="selectbut">JSS 1</option>
              <option value="JSS 2" class="selectbut">JSS 2</option>
              <option value="JSS 3" class="selectbut">JSS 3</option>
              <option value="SSS 1" class="selectbut">SSS 1</option>
              <option value="SSS 2" class="selectbut">SSS 2</option>
              <option value="SSS 3" class="selectbut">SSS 3</option>
             </select>
             
             <select value="" id="term" class="selectbut" required title="Select Term">
               <option value="">Term</option>
               <option value="1st term" class="selectbut">First Term</option>
               <option value="2nd term" class="selectbut">Second Term</option>
               <option value="3rd term" class="selectbut">Third Term</option>
              </select>
             
             <select value="" id="csubject" class="selectbut" required title="Select Subject">
              <option value="">Subject</option>
              <option value="ACC">Account</option>
              <option value="AGR">Agric. Sc</option>
              <option value="ARB">Arabic</option>
              <option value="BIO">Biology</option>
              <option value="BST1">Basic Science</option>
              <option value="BST2">Basic Technology</option>
              <option value="BST">Basic Science & Technology</option>
              <option value="BUS">Business Studies</option>
              <option value="CHE">Chemistry</option>
              <option value="CIV">Civic Education</option>
              <option value="COM">Commerce</option>
              <option value="CTR">Catring Services</option>
              <option value="DRN">Data Processing</option>
              <option value="ECO">Economics</option>
              <option value="ELE">Electrical</option>
              <option value="ENG">English Language</option>
              <option value="FUR">Further Mathematics</option>
              <option value="GEO">Geography</option>
              <option value="GOV">Government</option>
              <option value="GRM">Germent Maiking</option>
              <option value="HIS">History</option>
              <option value="ICT">Information Technology</option>
              <option value="IRS">Islamic Religion Studies</option>
              <option value="LIT">Literature</option>
              <option value="MAT">Mathematics</option>
              <option value="NAV">Regional and National Value</option>
              <option value="PHY">Physics</option>
              <option value="PRV">Pre-Vocational Studies</option>
              <option value="YOR">Yoruba Language</option>
            </select>
        </th>
					<th colspan="5" class="title">MARKSHEET TABULATED @
						<span id='timestamp'><h4>Date/Time:
							<script type="text/javascript">
							var currentTime = new Date()
							var hours = currentTime.getHours()
							var minutes = currentTime.getMinutes()
							var seconds =currentTime.getSeconds();
							
							if (minutes < 10){
							minutes = "0" + minutes
							}
							document.write(currentTime)
							if(hours > 11){
							document.write(" PM")
							} else {
							document.write(" AM")
							}
							//-->
							</script>
							</h4></span>
						</th>
            <th><button type="button" class="btn btn-danger"><em  class="foot">Class</em>: <span id="class">SSS 3</span></button></th>
					<th colspan="3"><button type="button" class="btn btn-danger"><em  class="foot">Subject</em>: <span id="subject">Biology</span></button></th>
					<th colspan="5"><button type="button" class="btn btn-danger"><em  class="foot">Term</em>: <span id="tterm">3rd term</span></button></th>
				</tr>
				<tr style="background: rgb(248, 103, 51);color: cornsilk;">
					<th style="width:10%;text-align: center;"><section class="btn btn-info" type="button">STUDENT NAMES | <button title="Filter student results"  class="btn btn-warning" type="button" onclick="$('.anu').toggle()"><span class="glyphicon glyphicon-list" style="color: white;background: darkgreen;"class="" ></button><button title="Add new Student"  class="btn btn-warning" type="button"><span class="glyphicon glyphicon-plus" style="color: white;background: darkgreen;"onclick="$('#addRow').toggle()" ></button><button title="Remove student(s) " class="btn btn-danger"><span class="glyphicon glyphicon-remove" style="color: white;background: darkgreen;" onclick="$('.rem').toggle()"></span></button></section></th>
					<th  style="width:2px;text-align: center;">TEST</th>
					<th>ATD</th>
					<th>ASSG </th>
					<th>TOTAL</th>
					<th>EXAM</th>
					<th>AGR</th>
					<th class="anu" hidden>2ND TERM</th>
					<th class="anu" hidden>1ST TERM</th>
					<th>ANNUAL</th>
					<th>AVR</th>
					<th>GRD</th>
					<th>POS</th>
					
				</tr>
			</thead>
			<tfoot>
				<th>
					<div  id="addRow" hidden><label for="">Add a Student: </label>
						<select name="" id="addstudent" class="btn btn-info">
							<option value="">Select a student name to add</option>
						</select>
					</div>
				</th>
				<th colspan="3" class="title">
					<button type="button" class="btn btn-primary"><em  class="foot">Teacher</em>: <span id="teacher"> Mall. Busari Abbas Olalekan</span></button> | <button type="button" class="btn btn-primary"><em  class="foot">HOD</em>: <span id="hod"> Mall. Busari Abbas Olalekan</span></button>
				</th>
				<th colspan="4">
					<div class="edit-buttons">
						<button type="button" class="btn btn-info" title="reload" onclick="reload()"><span class="glyphicon glyphicon-refresh" style="color: white;"> Reload</span></button>
						<button type="button" class="btn btn-success" title="Final save of work for printing" onclick="saveState ()"><span class="glyphicon glyphicon-saved" style="color: white;"> Save</span></button>
						<button type="button" class="btn btn-primary" title="Print document in pdf"  onclick="linkTable()"><span class="glyphicon glyphicon-download-alt" style="color: white;"> Print</span></button>
					</div>
				</th>
				<th colspan="3"><button type="button" class="btn btn-danger"><em  class="foot">AGR </em>: <span id="sumAll">231</span></button></th>
				<th colspan="2">
				<button type="button" class="btn btn-danger"><em  class="foot">PER(%) </em>: <span id="percentage">231</span></button>
				</th>
				<th>
				</th>
			</tfoot>
			
      </tbody>
	  
		</tbody>
	</table>
	
<!-- partial -->
<script src="https://www.gstatic.com/firebasejs/7.19.1/firebase-app.js"></script> 
<script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-database.js"></script> <!-- TODO: Add SDKs for Firebase products that you want to use--> 
<script src="https://www.gstatic.com/firebasejs/7.14.1/firebase-auth.js"></script>

	<script>
		var statusErrorMap = {
			'0': "Not connected.\nPlease verify your network connection.",
			'400' : "Server understood the request, but request content was invalid.",
			'401' : "Unauthorized access.",
			'403' : "Forbidden resource can't be accessed.",
			'404': "The requested page not found.",
			'500' : "Internal server error.",
			'503' : "Service unavailable.",
			'parsererror' : "Requested JSON parse failed.",
			'timeout': "Time out error.",
			'abort': "Ajax request aborted.",
								};
		var department = {
			'Sc': "Mall. Busari Abbas Olalekan",
			'Hum' : "Mall. Adisa Muritadah Olalekan",
			'Art' : "Mall. Oladejo Kabir Adewale",
			'' : "Others",
								};
		var save = {};var names = {};var agrigates = [];var source = [];var sourceCopy = [];
		genRow(JSON.parse(localStorage.getItem(localStorage.getItem('subjectContainer')))); 
		function nrows (n, i) {
			var sn = 1+i;
			names['id_'+""+i] = {'name':n};names.sn = sn;
			var tr = 
			'<tr id=hide_'+""+i+'><td>'+ '['+sn+'] '+'<input type="text" id='+"student_id_"+""+i+ ' value="AA/J/24/1436" hidden>'+
				'<span class="stn">'+n+'</span>' 
				+'</td>'+
				'<td class="forTd" title="input test score"><input type="number" min="0" max="20" class="inputs" id='+"test_"+""+i+' value="0"></td>'+
				'<td class="forTd"title="input assignment score"><input type="number" min="0" max="5" class="inputs" id='+"agn_"+""+i+' value="5"></td>'+
				'<td class="forTd" title="input attendance score"><input type="number" min="0" max="5" class="inputs" id='+"atd_"+""+i+' value="5"></td>'+
				'<td id='+"ttot_"+""+i+'>30</td>'+
				'<td class="forTd"title="input exam score"><input type="number" min="0" max="70" class="inputs" id='+"exam_"+""+i+' value="0"></td>'+
				'<td id='+"agr_"+""+i+'>100</td>'+
				'<td class="anu" title="input 2nd term score" hidden><input type="number" min="0" max="100" class="inputs" id='+"send_"+""+i+' value="0"></td>'+
				'<td class="anu" title="input 1st term score" hidden><input type="number" min="0" max="100" class="inputs" id='+"frst_"+""+i+' value="0"></td>'+
				'<td id='+"anu_"+""+i+'>300</td>'+
				'<td id='+"avg_"+""+i+'>100</td>'+
				'<td id='+"grd_"+""+i+'>A1</td>'+
				'<td id='+"pos_"+""+i+'>1st</td>'+
				'<td class="rem" hidden><button type="button" class="close" aria-hidden="true" onclick="deleteRows(this)">'+'&times;'+'</button></td>'+
			'</tr>'
					return tr
							};
		var array = listOfnames ();
		$('#addstudent').change(function(){
			var table = document.getElementById('inputTable')
			addRow(array[$(this).val()], table.rows.length - 3)
		});
		
		function listOfnames (){
			var array = [];
			var names = JSON.parse(localStorage.getItem(localStorage.getItem('subjectContainer')))
				if (name){
					for (var i = 0; i < names.sn; i++){
					$('#addstudent').append('<option value='+""+i+'>'+names['id_'+""+i].name+'</option>');
					array.push(names['id_'+""+i].name)
				}
				}
			
		return array}

		function deleteRows(x){
			var rows = document.getElementById('inputTable');
      var ind = Number(x.parentNode.parentNode.rowIndex);
			rows.deleteRow(ind)
		}
		function addRow(name, i) {
			$('table tbody').append(nrows(name, i));
			};
		
		function genRow (out){
					if (out){
						for (var i = 0; i < out.sn; i++){
						out['id_'+""+i].name
							$('table tbody').append(nrows(out['id_'+""+i].name, i));
							document.getElementById('student_id_'+""+i).value = out['id_'+""+i].student_id;
							document.getElementById('test_'+""+i).value = out['id_'+""+i].test;
							document.getElementById('agn_'+""+i).value = out['id_'+""+i].agn;
							document.getElementById('atd_'+""+i).value = out['id_'+""+i].atd;
							document.getElementById('exam_'+""+i).value = out['id_'+""+i].exam;
							document.getElementById('frst_'+""+i).value = out['id_'+""+i].frst;
							document.getElementById('send_'+""+i).value = out['id_'+""+i].send;
							$("#ttot_"+""+i).html(out['id_'+""+i].ttot);
							$("#agr_"+""+i).html(out['id_'+""+i].agr);
							$("#grd_"+""+i).html(out['id_'+""+i].grade);
							$("#pos_"+""+i).html(out['id_'+""+i].pos);
							$("#anu_"+""+i).html(out['id_'+""+i].anu);
							$("#avg_"+""+i).html(out['id_'+""+i].avg);
				}
					}
				if (localStorage.getItem('term') == '3rd term'){$(".anu").show()};
			};
			
			/**/
			var sum = sum = x => eval(x.join("+"));
			function average(i){
				var arr, each, x; arr = [];
					x = i.length;
					while(x != 0){
						each = i.shift();
						if (each != 0){
							arr.push(each);
							}; 
						x = i.length
						}
						return sum(arr)/arr.length;};
		
	function getInputs(rownum){
			var tTest = sum([$('#test_'+rownum).val(), $('#agn_'+rownum).val(), $('#atd_'+rownum).val()]);
			var tExam = sum([tTest, $('#exam_'+rownum).val()]);
            var first = Number($("#frst_"+rownum).val());
            	if (localStorage.getItem('term') == '1st term'){first = tExam};
            var second = Number($("#send_"+rownum).val());
            	if (localStorage.getItem('term') == '2nd term'){second = tExam};
			var tagr = sum([tExam, second, first]);
            var avg = average([tExam, second, first]).toFixed(2);
			var grd = grades(tExam, ($("#sclass").val())[0]);
					gradeCounter.push(grd);
					$("#ttot_"+rownum).html(tTest);$("#agr_"+rownum).html(tExam);$("#anu_"+rownum).html(tagr);$("#avg_"+rownum).html(avg);$("#grd_"+rownum).html(grd);
					save['id_'+rownum] = {/*[ZAINULABIDEEN MARYAM, 10, 5, 5, 20, 37, 57, 57, 54, 111, 57, C, 27th]*/
					'student_id':$("#student_id_"+rownum).val(),
					'name':names['id_'+rownum].name,
					'test':Number($("#test_"+rownum).val()), 
					'agn':Number($("#agn_"+rownum).val()), 
					'atd':Number($("#atd_"+rownum).val()), 
					'ttot':tTest,
					'exam':Number($("#exam_"+rownum).val()), 
                  	'agr': tExam,  
					'send':second, 
                  	'frst':first,
					'anu':tagr, 
					'avg':avg,
					'grade':grd,
					'pos':'th',
					'sn':rownum
								}
					};
					$(document).on('input', '.inputs', function () {
						var calculated_total_sum;
						var rownum = $(this).attr('id').split('_')[1];
						getInputs(rownum);
									;}
					);
			function refresh (){
						for (var i = 0; i < JSON.parse(localStorage.getItem(localStorage.getItem('subjectContainer'))).sn; i++){
							getInputs(i);
						}};
			function reload(){
				var out = JSON.parse(localStorage.getItem(localStorage.getItem('subjectContainer')))
				if (out){
						for (var i = 0; i < out.sn; i++){
							document.getElementById('test_'+""+i).value = 0;
							document.getElementById('agn_'+""+i).value = 0;
							document.getElementById('atd_'+""+i).value = 0;
							document.getElementById('exam_'+""+i).value = 0;
						}
					}
			};
			function saveState (){
					refresh ()
            		save.timestamp = currentTime;
						agrigates = [];
					if(localStorage.getItem('term') == '3rd term'){
						for (var i = 0; i < names.sn; i++){
										agrigates.push(save['id_'+""+i].avg);
									};
						}
					else{
						for (var i = 0; i < names.sn; i++){
										agrigates.push(save['id_'+""+i].agr);
									};
					}
								
								var sumAll = sum(agrigates); var percent = (sum(agrigates)/agrigates.length).toFixed(2);
								$("#sumAll").html(sumAll.toFixed(2));save.sumAll = sumAll.toFixed(2);save.percent = percent;$("#percentage").html(percent);
								var pos = positions(rankDuplicate(agrigates));
								for (var i = 0; i < pos.length; i++){
									save['id_'+""+i].pos = pos[i];
									$("#pos_"+i).html(pos[i])
								};
								save.sn = names.sn;
								localStorage.setItem(localStorage.getItem('subjectContainer'), JSON.stringify(save));

						      
							};
				  	
					function grades(x, y){
                            switch(y){
                            case "S":
                                if (x >=0 && x <=39){grd = "F9";};
                                if (x >=40 && x <=44){grd = "E8";}; 
                                if (x >=45 && x <=49){grd = "D7";}; 
                                if (x >=50 && x <=54){grd = "C6";};
                                if (x >=55 && x <=59){grd = "C5";};
                                if (x >=60 && x <=64){grd = "C4";};
                                if (x >=65 && x <=69){grd ="B3";};
                                if (x >=70 && x <=74){grd = "B2";};
                                if (x >=75 && x <=100){grd = "A1";};
                                break
                            case "J":
                                if (x >=0 && x <=39){grd = "F";};
                                if (x >=40 && x <=49){grd = "P";};
                                if (x >=50 && x <=69){grd = "C";};
                                if (x >=70 && x <=100){grd = "A";};
                                break
                                };
								return grd; 
                            };
							var gradeCounter = [];
				function positions(size){
										posi = []
										for (var i = 0; i < size.length;  i++){
											var it = ""+size[i];
											if (size[i] == 11 || size[i] == 12 || size[i] == 13){posi.push(""+size[i]+'th');}
											else{
												if (it.endsWith("1") || it.endsWith("2") || it.endsWith("3") || size[i] == 1 || size[i] == 2 || size[i] == 3){
													if (it.endsWith("1") || size[i] == 1){posi.push(it+'st');};
													if (it.endsWith("2") || size[i] == 2){posi.push(it+'nd');};
													if (it.endsWith("3") || size[i] == 3){posi.push(it+'rd');};}  
												else{posi.push(""+size[i]+'th');}};}
										return posi;};

										function rankDuplicate(arr) {
											const sorted = [...new Set(arr)].sort((a, b) => b - a);
											const rank = new Map(sorted.map((x, i) => [x, i + 1]));
											return arr.map((x) => rank.get(x));
											}

                      $("#csubject").change(function(){
						var arr = ['', 'JSS 1', 'JSS 2', 'JSS 3', 'SSS 1', 'SSS 2', 'SSS 3'];
						var trm = ['', '1st term', '2nd term', '3rd term']
                        if (($("#sclass").val()) && ($("#csubject").val()) && ($("#term").val())){
							localStorage.setItem('term', $("#term").val());
							localStorage.setItem('class', $("#sclass").val());
							localStorage.setItem('subject', $("#csubject").val());
							localStorage.setItem('subjectContainer', $("#csubject").val()+ "_"+arr.indexOf($("#sclass").val())+"_"+trm.indexOf($("#term").val()));
						  go_to_load_data()	
                        }
                        else{
                          alert("select the student class, term then subject!")
                          document.getElementById('csubject').value = '';
                        }
                      });
	
											function showOnly(x){$("."+x).hide();$(".oneBox, .newBox").toggle();};
											
											
							function countGrade(gradeCounter){
											var grades = gradeCounter.reduce(function(prev, cur){prev[cur] = (prev[cur] || 0) + 1; return prev;},{});
											$("#A").html(grades.A);$("#C").html(grades.C);$("#P").html(grades.P);$("#F").html(grades.F);
											$("#F9").html(grades.F9);$("#E8").html(grades.E8);$("#D7").html(grades.D7);$("#C6").html(grades.C6);$("#C5").html(grades.C5);$("#C4").html(grades.C4);$("#B3").html(grades.B3);$("#B2").html(grades.B2);$("#A1").html(grades.A1);
										};//alert($("#Subject").val()+'_'+$("#Class").val().split(' ')[1]+'_'+$("#Term").val()[0])
										function share(){
												var link = window.location.href;
												window.open('whatsapp://send?text=' + link)
											};
           				 updateTable ();
          function updateTable (){
				$('#title').html(localStorage.getItem('term')+'_'+localStorage.getItem('class')+'_'+localStorage.getItem('subject'))
				document.getElementById('csubject').value = 	localStorage.getItem('subject')
				$('#subject').html(localStorage.getItem('subject')); 
				document.getElementById('sclass').value = 	localStorage.getItem('class')
				$('#class').html(localStorage.getItem('class')); 
				document.getElementById('term').value = 	localStorage.getItem('term')
				$('#tterm').html(localStorage.getItem('term')); 
				$('#teacher').html(localStorage.getItem('displayName')); 
				
			};
		function linkTable(){
				saveState ();/*[1, 2, 14,5,5,24,36,60,C4,4th,60,60]*/
				var next = window.location.href.replace('tablefrozen/48/', 'subject_home_pdf/')
				var array = [];var list, itr;
				var out = JSON.parse(localStorage.getItem(localStorage.getItem('subjectContainer')))
				for (var i = 0; i < out.sn;  i++){
					itr = ""+i;
					list = [out['id_'+itr].student_id.split('/')[3],
							out['id_'+itr].student_id,
							out['id_'+itr].test,
							out['id_'+itr].agn,
							out['id_'+itr].atd,
							out['id_'+itr].ttot,
							out['id_'+itr].exam,
							out['id_'+itr].agr,
							out['id_'+itr].grade,
							out['id_'+itr].pos,
							out['id_'+itr].frst,
							out['id_'+itr].send]	
						array.push(list);};
						var array = JSON.stringify(array);
						var request = $.ajax({
								type:'POST',
								data:{'content':array},
								url:"{% url 'responsive_updates' pk=0 %}",
								dataType: 'json',
								success: function(data) {
									location.replace(next);
										}
									});
								request.fail(function(jqXHR, textStatus, data) {
									alert(statusErrorMap[jqXHR.status]);
			  						});
				
								}	
						
		function go_to_load_data(){
							var next = window.location.href;
							var request = $.ajax({
								url: "{% url 'responsive_updates' pk=0 %}",
								data: {'Class':localStorage.getItem('class'),'Subject':localStorage.getItem('subject'),'Term':localStorage.getItem('term'), 'flow':"toHtml", 'tutor_id':48},
								dataType: 'json',
								success: function(data) {
								if (data.status){
									alert(data.status);
									alert(data.tutor_name);
									alert(data.hod);
									var save = {};
									localStorage.setItem('displayName', data.list.shift(0));
									var term = localStorage.getItem('term');
									save.sn = data.list.length;
								for (var i = 0; i < data.list.length; i++){
									var frt = Number(data.list[i][9]);
										if (term = '1st term'){frt = sum([Number(data.list[i][2]), Number(data.list[i][3]), Number(data.list[i][4]), Number(data.list[i][5])])};
									var sec = Number(data.list[i][10]);
										if (term = '2nd term'){sec = sum([Number(data.list[i][2]), Number(data.list[i][3]), Number(data.list[i][4]), Number(data.list[i][5])])};
									var trd = 0;
										if (term = '3rd term'){trd = sum([Number(data.list[i][2]), Number(data.list[i][3]), Number(data.list[i][4]), Number(data.list[i][5])])};
								save['id_'+i] = {
										'name':data.list[i][0],
										'student_id':data.list[i][1],
										'test':Number(data.list[i][2]),
										'agn':Number(data.list[i][3]),
										'atd':Number(data.list[i][4]),
										'ttot':sum([Number(data.list[i][2]), Number(data.list[i][3]), Number(data.list[i][4])]),
										'exam':Number(data.list[i][5]),
										'agr':sum([Number(data.list[i][2]), Number(data.list[i][3]), Number(data.list[i][4]), Number(data.list[i][5])]),
										'send':sec,
										'frst':frt,
										'anu':sum([frt, sec, trd]),
										'avg':average([frt, sec, trd]),
										'grade':data.list[i][6],
										'pos':data.list[i][7]
							}};
							localStorage.setItem(localStorage.getItem('subjectContainer'), JSON.stringify(save));
							
										};
										
							}}).then(function () {
							location.replace(next);
							});
							request.fail(function( jqXHR, textStatus) {
								alert(statusErrorMap[jqXHR.status]);
											});
										
						
										}		
	</script>
	
</body>
<div class="content container">
            <div class="row">
                <div class="col-md-8">
                <div style="color:white;cursor:pointer;background-color:black;border-radius:5px;border:1px solid white;width:6%;text-align:center;font-weight:bold;line-height:65%;" id="back"><span class="glyphicon glyphicon-backward" title="Click next to enter student scores"></span></div>
                <script>
                    $("#back").click(function() {
                    var oldurl = document.referrer;
                    location.replace(oldurl)
                    })
                </script>
                </div>
            </div>
        </div>
		
		<footer class="cd__credit">Author: kevin - Distributed By: <a title="Free web design code & scripts" href="https://www.codepel.com?source=demo-page" target="_blank">CodePel</a>
</body>

</html>
